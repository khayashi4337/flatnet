# Flatnet ロードマップ

全体を4つのPhaseに分けて段階的に構築する。

---

## Phase 1: 基盤構築

| 項目 | 内容 |
|------|------|
| **前提条件** | WSL2 + Podman がインストール済み、Rust 開発環境が利用可能 |
| **目標** | 最小構成で Flatnet CNI プラグインが動作し、同一ホスト上のコンテナ間通信ができる |
| **内容** | Rust製CNIプラグインの実装、ネットワーク名前空間操作、コンテナ間オーバーレイ通信 |
| **終了条件** | Podman上の2コンテナがFlatnet経由で相互pingでき、Forgejo+RunnerでCI実行が成功する |
| **備考** | 単一ホスト（WSL2内）での動作が対象。マルチノードは Phase 3 で対応 |

詳細: [Phase 1 詳細](./phase-1/README.md)

---

## Phase 2: Gateway 統合

| 項目 | 内容 |
|------|------|
| **前提条件** | Phase 1 完了、Windows 上で OpenResty が利用可能 |
| **目標** | 社内メンバーがブラウザから Forgejo にアクセスできる |
| **内容** | OpenResty によるリバースプロキシ設定、WSL2内コンテナへのルーティング、TLS終端 |
| **終了条件** | Windows ホストの 80/443 ポート経由で Forgejo の Web UI にアクセスできる |
| **備考** | VPNなしでアクセス可能にすることが重要。この時点ではLAN内アクセスのみ |

要望:
社内メンバーのPCに、リモートでテストできる環境があるとテストがはかどりそう
sshでログインできるようになっていたら、そこからcurlコマンドで疎通確認ができるのでは？


---

## Phase 3: マルチノード対応

| 項目 | 内容 |
|------|------|
| **前提条件** | Phase 2 完了、複数の WSL2 ホストが同一ネットワーク上に存在 |
| **目標** | 複数ホストにまたがるコンテナが Flatnet で直接通信できる |
| **内容** | Lighthouse による経路情報管理、ホスト間トンネル構築、IP アドレス管理の中央化 |
| **終了条件** | 異なるホスト上のコンテナ同士が Flatnet IP で相互に通信できる |
| **備考** | Nebula や WireGuard 等のメッシュVPN技術の活用を検討 |

---

## Phase 4: 本番運用準備

| 項目 | 内容 |
|------|------|
| **前提条件** | Phase 3 完了 |
| **目標** | 安定した本番運用ができる状態にする |
| **内容** | 監視・ログ収集、障害時の自動復旧、セキュリティ強化、ドキュメント整備 |
| **終了条件** | 1週間の連続運用テストを問題なく完了、運用手順書が整備されている |
| **備考** | リモートメンバー対応（VPN経由アクセス）もこのフェーズで検討 |

---

## 全体スケジュール概観

```
Phase 1: 基盤構築        [===>          ] 現在
Phase 2: Gateway統合     [              ]
Phase 3: マルチノード    [              ]
Phase 4: 本番運用準備    [              ]
```
