# Flatnet Vulnerability Scan Report

## Scan Information

| Field | Value |
|-------|-------|
| Scan Date | YYYY-MM-DD HH:MM:SS |
| Scan Type | Container / Dependency / Network |
| Scanner | Trivy / cargo-audit / nmap |
| Scanner Version | |
| Operator | |

---

## 1. Executive Summary

### Vulnerability Counts

| Severity | Count | Fixed Available |
|----------|-------|-----------------|
| Critical | 0 | 0 |
| High | 0 | 0 |
| Medium | 0 | 0 |
| Low | 0 | 0 |
| Unknown | 0 | 0 |

### Risk Assessment

| Rating | Description |
|--------|-------------|
| **[PASS/FAIL]** | Summary of whether the scan passes security policy |

---

## 2. Container Image Scans

### 2.1 Gateway Image

**Image:** `flatnet/gateway:latest`
**Digest:** `sha256:...`
**Scanned:** YYYY-MM-DD

#### OS Packages

| Package | Installed | Fixed In | Vulnerability | Severity |
|---------|-----------|----------|---------------|----------|
| | | | CVE-XXXX-XXXXX | |

#### Language Packages

| Package | Version | Vulnerability | Severity | Fixed Version |
|---------|---------|---------------|----------|---------------|
| | | CVE-XXXX-XXXXX | | |

---

### 2.2 Forgejo Image

**Image:** `codeberg.org/forgejo/forgejo:X`
**Digest:** `sha256:...`
**Scanned:** YYYY-MM-DD

#### Vulnerabilities

| Package | Installed | Fixed In | Vulnerability | Severity |
|---------|-----------|----------|---------------|----------|
| | | | | |

---

### 2.3 Other Container Images

[Repeat for each scanned image]

---

## 3. Rust Dependency Scan (cargo-audit)

### 3.1 CNI Plugin Dependencies

**Cargo.lock Hash:** `...`
**Scanned:** YYYY-MM-DD

#### Advisories

| Crate | Version | Advisory ID | Title | Severity |
|-------|---------|-------------|-------|----------|
| | | RUSTSEC-XXXX-XXXX | | |

#### Advisory Details

##### RUSTSEC-XXXX-XXXX: [Title]

- **Crate:** `crate-name`
- **Version:** `X.Y.Z`
- **Severity:** Critical/High/Medium/Low
- **Patched in:** `X.Y.Z`
- **Description:** [Description from advisory]
- **More info:** https://rustsec.org/advisories/RUSTSEC-XXXX-XXXX

**Remediation:**
```toml
# Update Cargo.toml
[dependencies]
crate-name = "X.Y.Z"  # Updated version
```

---

## 4. Network Port Scan

### 4.1 External Facing (LAN)

**Host:** [Windows Host IP]
**Scanned:** YYYY-MM-DD

| Port | State | Service | Version | Notes |
|------|-------|---------|---------|-------|
| 80/tcp | open | http | OpenResty | Gateway |
| 443/tcp | open | https | OpenResty | Gateway (TLS) |

### 4.2 WSL2 Internal

**Host:** [WSL2 IP]
**Scanned:** YYYY-MM-DD

| Port | State | Service | Notes |
|------|-------|---------|-------|
| 3000/tcp | open | http | Forgejo |
| 9090/tcp | open | http | Prometheus |
| 3001/tcp | open | http | Grafana |

---

## 5. Vulnerability Details

### 5.1 Critical Vulnerabilities

#### CVE-XXXX-XXXXX

| Attribute | Value |
|-----------|-------|
| CVE ID | CVE-XXXX-XXXXX |
| CVSS v3 | X.X (Critical) |
| Affected Component | |
| Affected Version | |
| Fixed Version | |

**Description:**
[Detailed description of the vulnerability]

**Impact:**
[Description of potential impact if exploited]

**Remediation:**
```bash
# Remediation steps
```

**References:**
- https://nvd.nist.gov/vuln/detail/CVE-XXXX-XXXXX
- [Vendor advisory link]

---

### 5.2 High Vulnerabilities

[Repeat format for high severity vulnerabilities]

---

### 5.3 Medium Vulnerabilities

[Repeat format for medium severity vulnerabilities]

---

## 6. Remediation Plan

### Immediate Actions (Critical)

| Vulnerability | Component | Action | Owner | Due Date |
|---------------|-----------|--------|-------|----------|
| CVE-XXXX-XXXXX | | Upgrade to X.Y.Z | | |

### Short-term Actions (High)

| Vulnerability | Component | Action | Owner | Due Date |
|---------------|-----------|--------|-------|----------|
| | | | | |

### Deferred (Medium/Low)

| Vulnerability | Component | Action | Target Release |
|---------------|-----------|--------|----------------|
| | | | |

### Risk Accepted

| Vulnerability | Component | Justification | Approved By | Date |
|---------------|-----------|---------------|-------------|------|
| | | | | |

---

## 7. Scan Commands Used

### Trivy Container Scan

```bash
# Full scan with JSON output
trivy image --format json --output trivy-report.json flatnet/gateway:latest

# High/Critical only
trivy image --severity HIGH,CRITICAL flatnet/gateway:latest

# With ignore file
trivy image --ignorefile .trivyignore flatnet/gateway:latest
```

### Cargo Audit

```bash
# Standard scan
cargo audit

# JSON output
cargo audit --json > cargo-audit-report.json

# With deny file
cargo audit --deny warnings
```

### Nmap Port Scan

```bash
# Quick scan
nmap -sT -p 80,443,3000,9090 <target>

# Service version detection
nmap -sV -p- <target>
```

---

## 8. Appendices

### Appendix A: Full Trivy Output

```json
[Full JSON output]
```

### Appendix B: Full cargo-audit Output

```
[Full output]
```

### Appendix C: Ignored Vulnerabilities

| Vulnerability | Reason for Ignoring | Approved By | Review Date |
|---------------|---------------------|-------------|-------------|
| | | | |

---

## Approval

| Role | Name | Date |
|------|------|------|
| Scanner | | |
| Reviewer | | |

---

## Related Documents

- [Security Audit Checklist](./audit-checklist.md) - Checklist for performing audits
- [Audit Report Template](./audit-report-template.md) - Template for documenting audit findings
- [Incident Response Procedures](./incident-response.md) - Procedures for handling security incidents

## Scanning Tools

- Container scanning: `scripts/security/scan-containers.sh`
- Rust dependency scanning: `scripts/security/scan-rust-deps.sh`
