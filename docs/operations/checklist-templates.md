# Flatnet 運用チェックリストテンプレート

このドキュメントでは、Flatnet システムの運用で使用する各種チェックリストのテンプレートを提供します。

## 目次

1. [日次運用チェックリスト](#日次運用チェックリスト)
2. [週次運用チェックリスト](#週次運用チェックリスト)
3. [月次運用チェックリスト](#月次運用チェックリスト)
4. [メンテナンス前チェックリスト](#メンテナンス前チェックリスト)
5. [メンテナンス後チェックリスト](#メンテナンス後チェックリスト)
6. [インシデント対応チェックリスト](#インシデント対応チェックリスト)
7. [新規ホスト追加チェックリスト](#新規ホスト追加チェックリスト)
8. [リストアテストチェックリスト](#リストアテストチェックリスト)

---

## 日次運用チェックリスト

**実施者:** _________________ **日付:** ____/____/____

### システム状態確認

| # | 確認項目 | 確認方法 | 結果 | 備考 |
|---|----------|----------|------|------|
| 1 | Grafana ダッシュボード確認 | http://localhost:3000 | [ ] OK [ ] NG | |
| 2 | アクティブアラートなし | Alertmanager 確認 | [ ] OK [ ] NG | |
| 3 | Gateway 稼働中 | `Get-Process nginx` | [ ] OK [ ] NG | |
| 4 | 監視スタック稼働中 | `podman-compose ps` | [ ] OK [ ] NG | |
| 5 | エラーログ確認 | Gateway/監視ログ | [ ] OK [ ] NG | |

### コマンド実行結果

```
# Gateway 確認
Get-Process nginx: _________________

# 監視スタック確認
podman-compose ps:
_________________
_________________
_________________

# アラート確認
curl http://localhost:9093/api/v2/alerts:
_________________
```

### 確認者サイン

確認者: _________________ 日時: ____/____/____ __:__

---

## 週次運用チェックリスト

**実施者:** _________________ **週:** ____年 第____週

### リソース確認

| # | 確認項目 | 確認方法 | 結果 | 値 |
|---|----------|----------|------|-----|
| 1 | WSL2 ディスク使用量 | `df -h` | [ ] OK [ ] NG | ___% |
| 2 | Windows ログサイズ | Get-ChildItem | [ ] OK [ ] NG | ___MB |
| 3 | Podman ストレージ | `podman system df` | [ ] OK [ ] NG | ___GB |
| 4 | バックアップ成功確認 | バックアップログ | [ ] OK [ ] NG | |
| 5 | 証明書有効期限 | `nebula-cert.exe print` | [ ] OK [ ] NG | 残 ___日 |

### メンテナンス作業

| # | 作業項目 | 実施 | 備考 |
|---|----------|------|------|
| 1 | 古いログファイルの削除 | [ ] 完了 [ ] 不要 | |
| 2 | 不要なコンテナイメージの削除 | [ ] 完了 [ ] 不要 | |
| 3 | Podman prune 実行 | [ ] 完了 [ ] 不要 | |

### 備考

```
_________________________________________________________________
_________________________________________________________________
_________________________________________________________________
```

---

## 月次運用チェックリスト

**実施者:** _________________ **月:** ____年____月

### セキュリティ確認

| # | 確認項目 | 結果 | 備考 |
|---|----------|------|------|
| 1 | WSL2 パッケージアップデート確認 | [ ] OK [ ] 要対応 | |
| 2 | セキュリティパッチ適用 | [ ] 完了 [ ] 予定 | |
| 3 | コンテナイメージ脆弱性スキャン | [ ] OK [ ] 要対応 | |
| 4 | アクセスログ監査 | [ ] OK [ ] 要確認 | |

### メンテナンス作業

| # | 作業項目 | 実施 | 備考 |
|---|----------|------|------|
| 1 | コンテナイメージ更新 | [ ] 完了 [ ] 不要 | |
| 2 | リストアテスト実施 | [ ] 完了 | テスト結果: OK/NG |
| 3 | ドキュメント更新確認 | [ ] 完了 | |
| 4 | 運用レポート作成 | [ ] 完了 | |

### パフォーマンス確認

| メトリクス | 先月平均 | 今月平均 | 評価 |
|-----------|---------|---------|------|
| Gateway レスポンスタイム | ___ms | ___ms | [ ] OK [ ] 要調査 |
| エラーレート | ___% | ___% | [ ] OK [ ] 要調査 |
| CPU 使用率 | ___% | ___% | [ ] OK [ ] 要調査 |
| メモリ使用率 | ___% | ___% | [ ] OK [ ] 要調査 |

---

## メンテナンス前チェックリスト

**メンテナンス名:** _________________
**予定日時:** ____/____/____ __:__ 〜 __:__
**担当者:** _________________

### 事前準備

| # | 確認項目 | 確認 | 備考 |
|---|----------|------|------|
| 1 | メンテナンス日時が決定されている | [ ] | |
| 2 | 影響範囲が確認されている | [ ] | 影響サービス: _______ |
| 3 | 関係者への告知が完了している | [ ] | 告知日: ____/____/____ |
| 4 | バックアップが取得されている | [ ] | バックアップ日時: _______ |
| 5 | ロールバック手順が確認されている | [ ] | |
| 6 | 必要なファイル/バイナリが準備されている | [ ] | |
| 7 | テスト環境での検証が完了している | [ ] / N/A | |
| 8 | 監視アラート停止の準備ができている | [ ] | |

### 連絡先確認

| 役割 | 担当者 | 連絡先 | 確認 |
|------|--------|--------|------|
| 作業責任者 | _______ | _______ | [ ] |
| エスカレーション先 | _______ | _______ | [ ] |
| 緊急連絡先 | _______ | _______ | [ ] |

---

## メンテナンス後チェックリスト

**メンテナンス名:** _________________
**完了日時:** ____/____/____ __:__
**担当者:** _________________

### サービス確認

| # | 確認項目 | 確認方法 | 結果 | 備考 |
|---|----------|----------|------|------|
| 1 | Gateway 稼働確認 | `curl http://localhost/` | [ ] OK [ ] NG | |
| 2 | API ヘルスチェック | `/api/health` | [ ] OK [ ] NG | |
| 3 | Prometheus 稼働確認 | `/-/ready` | [ ] OK [ ] NG | |
| 4 | Grafana 稼働確認 | `/api/health` | [ ] OK [ ] NG | |
| 5 | Alertmanager 稼働確認 | `/-/ready` | [ ] OK [ ] NG | |
| 6 | Loki 稼働確認 | `/ready` | [ ] OK [ ] NG | |
| 7 | 全コンテナ稼働確認 | `podman ps` | [ ] OK [ ] NG | |

### ログ確認

| # | 確認項目 | 結果 | 備考 |
|---|----------|------|------|
| 1 | Gateway エラーログ | [ ] エラーなし [ ] 要確認 | |
| 2 | 監視スタックログ | [ ] エラーなし [ ] 要確認 | |

### 事後作業

| # | 作業項目 | 完了 | 備考 |
|---|----------|------|------|
| 1 | 監視アラートの再開 | [ ] | |
| 2 | 完了通知の送信 | [ ] | |
| 3 | 作業報告書の作成 | [ ] | |
| 4 | 古いバックアップの整理 | [ ] | |

---

## インシデント対応チェックリスト

**インシデント概要:** _________________
**発生日時:** ____/____/____ __:__
**対応者:** _________________

### 初期対応

| # | 対応項目 | 時刻 | 完了 | 備考 |
|---|----------|------|------|------|
| 1 | インシデント検知 | __:__ | [ ] | 検知方法: _______ |
| 2 | 影響範囲の確認 | __:__ | [ ] | |
| 3 | 関係者への一次連絡 | __:__ | [ ] | |
| 4 | ログ・証拠の保全 | __:__ | [ ] | |

### 調査・対応

| # | 対応項目 | 時刻 | 完了 | 備考 |
|---|----------|------|------|------|
| 1 | 原因調査 | __:__ | [ ] | 原因: _______ |
| 2 | ランブック参照 | __:__ | [ ] | 該当障害: _______ |
| 3 | 対処実施 | __:__ | [ ] | |
| 4 | 復旧確認 | __:__ | [ ] | |

### エスカレーション

| 状況 | エスカレーション先 | 連絡時刻 | 完了 |
|------|-------------------|----------|------|
| 30分で復旧しない | 開発チーム | __:__ | [ ] / N/A |
| データ損失の可能性 | マネージャー | __:__ | [ ] / N/A |
| セキュリティ関連 | セキュリティ担当 | __:__ | [ ] / N/A |

### 事後作業

| # | 作業項目 | 完了 | 備考 |
|---|----------|------|------|
| 1 | 復旧報告の送信 | [ ] | |
| 2 | インシデントレポートの作成 | [ ] | |
| 3 | 再発防止策の検討 | [ ] | |

---

## 新規ホスト追加チェックリスト

**ホスト名:** _________________
**Nebula IP:** 10.100._.1/16
**担当者:** _________________

### Lighthouse での準備

| # | 作業項目 | 完了 | 備考 |
|---|----------|------|------|
| 1 | 証明書生成 (`nebula-cert.exe sign`) | [ ] | |
| 2 | 証明書ファイルの確認 | [ ] | *.crt, *.key |
| 3 | 証明書の安全な転送 | [ ] | |

### 新規ホストでの作業

| # | 作業項目 | 完了 | 備考 |
|---|----------|------|------|
| 1 | ディレクトリ構成作成 | [ ] | F:\flatnet\... |
| 2 | Nebula バイナリ配置 | [ ] | |
| 3 | 証明書ファイル配置 | [ ] | |
| 4 | 設定ファイル作成 | [ ] | config.yaml |
| 5 | Windows Firewall 設定 | [ ] | UDP 4242 |
| 6 | Nebula サービス登録 | [ ] | NSSM |
| 7 | サービス起動 | [ ] | |

### 接続確認

| # | 確認項目 | 結果 | 備考 |
|---|----------|------|------|
| 1 | Lighthouse への ping | [ ] OK [ ] NG | `ping 10.100.0.1` |
| 2 | 既存ホストへの ping | [ ] OK [ ] NG | |
| 3 | ログに handshake 成功 | [ ] OK [ ] NG | |

### 追加設定（必要な場合）

| # | 作業項目 | 完了 | 備考 |
|---|----------|------|------|
| 1 | OpenResty セットアップ | [ ] / N/A | |
| 2 | CNI Plugin セットアップ | [ ] / N/A | |
| 3 | 監視スタックセットアップ | [ ] / N/A | |

---

## リストアテストチェックリスト

**テスト日:** ____/____/____
**テスト者:** _________________
**バックアップ日:** ____/____/____

### テスト準備

| # | 確認項目 | 完了 | 備考 |
|---|----------|------|------|
| 1 | テスト環境の準備 | [ ] | |
| 2 | バックアップファイルの確認 | [ ] | サイズ: ___MB |
| 3 | チェックサムの検証 | [ ] | |

### リストアテスト

| # | テスト項目 | 結果 | 備考 |
|---|-----------|------|------|
| 1 | 設定ファイルのリストア | [ ] PASS [ ] FAIL | |
| 2 | Grafana ダッシュボードのリストア | [ ] PASS [ ] FAIL | |
| 3 | JSON ファイルの整合性 | [ ] PASS [ ] FAIL | |

### テスト結果サマリ

| 項目 | 結果 |
|------|------|
| 設定ファイル | PASS / FAIL |
| Grafana ダッシュボード | PASS / FAIL |
| Prometheus データ | PASS / FAIL / N/A |
| 総合評価 | PASS / FAIL |

### 問題点・改善事項

```
_________________________________________________________________
_________________________________________________________________
_________________________________________________________________
```

### 承認

テスト者: _________________ 日付: ____/____/____
確認者: _________________ 日付: ____/____/____

---

## チェックリスト使用ガイドライン

### 記入ルール

1. **日付と担当者**: 必ず記入する
2. **結果**: OK/NG または PASS/FAIL を明確にマーク
3. **備考**: 問題点や特記事項があれば記入
4. **署名**: 確認者のサインを忘れずに

### 保管

- 完了したチェックリストは 1 年間保管
- 電子的に保存する場合はスキャンまたは写真
- インシデント関連は恒久保管

### 更新

- チェックリストの内容は定期的にレビュー
- 運用変更があった場合は更新
- バージョン管理を行う

---

## 関連ドキュメント

- [Daily Operations](daily-operations.md) - 日常運用ガイド
- [Runbook](runbook.md) - 障害対応手順
- [Backup/Restore](backup-restore.md) - バックアップ・リストア手順
- [Maintenance](maintenance.md) - メンテナンス手順
