# Flatnet Gateway - WebSocket Proxy Parameters
# Phase 1, Stage 2: WSL2 Proxy Configuration
#
# This file contains settings for WebSocket proxying.
# Required for applications like Forgejo that use WebSocket connections.
#
# Usage:
#   Include this file along with proxy-params.conf in location blocks:
#   location /wsl2-ws/ {
#       include F:/flatnet/config/conf.d/proxy-params.conf;
#       include F:/flatnet/config/conf.d/websocket-params.conf;
#       proxy_pass http://wsl2_backend/;
#   }

#------------------------------------------------------------------------------
# HTTP Version
#------------------------------------------------------------------------------

# WebSocket requires HTTP/1.1
proxy_http_version 1.1;

#------------------------------------------------------------------------------
# Connection Upgrade Headers
#------------------------------------------------------------------------------

# Pass the Upgrade header (required for WebSocket handshake)
proxy_set_header Upgrade $http_upgrade;

# Set Connection header to "upgrade" for WebSocket
proxy_set_header Connection "upgrade";

#------------------------------------------------------------------------------
# Extended Timeouts for WebSocket
#------------------------------------------------------------------------------

# WebSocket connections are typically long-lived
# Set longer timeouts to prevent premature disconnection

# Timeout for reading response (1 hour for WebSocket)
proxy_read_timeout 3600s;

# Timeout for sending request (1 hour for WebSocket)
proxy_send_timeout 3600s;
